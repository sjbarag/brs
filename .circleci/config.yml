version: 2.1

jobs:
  private-build-lint-test: &build-lint-test
    docker:
      - image: circleci/node # will be overridden
    steps:
      - checkout
      - run:
          name: Install dependencies
          command: yarn
      - run:
          name: Compile
          command: yarn build
      - run:
          name: Lint
          command: yarn lint
      - run:
          name: Test
          command: yarn test

  "Node 6":
    <<: *build-lint-test
    docker:
      - image: node:6

  "Node 8":
    <<: *build-lint-test
    docker:
      - image: node:8

  "Node 10":
    <<: *build-lint-test
    docker:
      - image: node:10

  "Node latest":
    <<: *build-lint-test
    docker:
        - image: node:latest

  "Chakra 8":
    <<: *build-lint-test
    docker:
        - image: node:chakracore-8

  "Chakra 10":
    <<: *build-lint-test
    docker:
        - image: node:chakracore-10

workflows:
  version: 2
  "Supported Node versions":
    jobs:
      - "Node 6"
      - "Node 8"
      - "Node 10"

  "Supported Chakra versions":
    jobs:
      - "Chakra 8"
      - "Chakra 10"
